{% extends 'base.html' %}
{% load custom_tags %}
{% block title %}Detail{% endblock %}

{% block content %}
<br>
<div class="container">
    <div class="row justify-content-center">
        <div class="col-8">
            <h5 class="text-center">{{ story.title }}</h5>
            <div class="card">
                <div class="card-body">
                  <h5 class="card-title">{{ story.title }}</h5>
                  <p class="card-text">{{ story.content }}</p>
                      <div class="row">
                          <div class="col-auto">
                            <span class="text-secondary text-secondary">{{ story | get_rate:'LIKE' }}</span>
                            <span class="text-secondary text-secondary">{{ story | get_rate:'DISLIKE' }}</span>
                            <span class="text-secondary">| author: {{ story.author }}</span>
                          </div>
                          <div class="col-auto">
                            <form>
                                <input type="hidden" name="rate" value="LIKE">
                                <button type="button" id="likeButton" class="btn btn-default btn-sm text-secondary" hx-post="{% url 'story:story-rate' story.slug %}" hx-target="#likeButton" hx-swap="outerHTML">
                                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"/>
                                  </svg>
                                </button>
                            </form>
                          </div>
                          <div class="col-auto">
                            <form>
                                <input type="hidden" name="rate" value="DISLIKE">
                                <button type="button" id="dislikeButton" class="btn btn-default btn-sm text-secondary" hx-post="{% url 'story:story-rate' story.slug %}" hx-target="#dislikeButton" hx-swap="outerHTML">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-down" viewBox="0 0 16 16">
                                      <path fill-rule="evenodd" d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z"/>
                                    </svg>
                                </button>
                            </form>
                          </div>
                      </div>
                </div>
            </div>
        </div>
        <div class="col-4">
            <h5 class="text-center">Characters</h5>
            {% for character in characters %}
            <div class="accordion accordion-flush" id="accordionFlushExample">
            <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingOne">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#character{{ forloop.counter }}" aria-expanded="false" aria-controls="flush-collapseOne">
                    {{ character.name }}
                </button>
                </h2>
                <div id="character{{ forloop.counter }}" class="accordion-collapse collapse" aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample">
                <div class="accordion-body">
                    <p>age: {{ character.age }} </p>
                    <p>species: {{ character.species }} </p>
                    <p>gender: {{ character.gender }} </p>
                    <p>review: {{ character.review }} </p>
                </div>
                </div>
            </div>
            </div>
            {% endfor %}
        </div>
    </div>
    <br>
    <div class="col-8">
        <form action="{% url 'story:comment-create' story.slug %}" method="post">
            <div class="input-group mb-3">
                <input type="text" name="deger" value="" class="form-control form-control-sm" placeholder="enter a title for continue the story" aria-label="Recipient's username" aria-describedby="button-addon2">
                <button class="btn btn-outline-secondary btn-sm" type="submit" id="button-addon2">Continue</button>
                {% csrf_token %}
            </div>
        </form>
    </div>
    <br>
    <div class="row jusitfy-content-center">
        <div class="col-12">
            {% for comment in comments %}
            <div class="card">
                <div class="card-body">
                <h5 class="card-title"><a href="{% url 'story:comment-detail' comment.slug %}" class="text-dark" style="text-decoration: none;">{{ comment.title }}</a></h5>
                <p class="card-text"><a href="{% url 'story:comment-detail' comment.slug %}" class="text-dark" style="text-decoration: none;">{{ comment.content | truncatewords:20 }}</a></p>
                </div>
                <div class="container">
                <div class="row">
                    <div class="col-auto">
                        <span class="text-secondary text-secondary">{{ comment | get_comment_rate:'LIKE' }}</span>
                        <span class="text-secondary text-secondary">{{ comment | get_comment_rate:'DISLIKE' }}</span>
                        <span class="text-secondary">| author: {{ comment.author }}</span>
                    </div>
                    <div class="col-auto">
                        <form>
                            <input type="hidden" name="rate" value="LIKE">
                            <button type="button" id="c{{forloop.counter}}commentlikeButton" class="btn btn-default btn-sm text-secondary" hx-post="{% url 'story:comment-rate' comment.slug %}" hx-target="#c{{forloop.counter}}commentlikeButton" hx-swap="outerHTML">
                              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"/>
                              </svg>
                            </button>
                        </form>
                      </div>
                      <div class="col-auto">
                        <form>
                            <input type="hidden" name="rate" value="DISLIKE">
                            <button type="button" id="c{{forloop.counter}}commentdislikeButton" class="btn btn-default btn-sm text-secondary" hx-post="{% url 'story:comment-rate' comment.slug %}" hx-target='#c{{forloop.counter}}commentdislikeButton' hx-swap="outerHTML">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-down" viewBox="0 0 16 16">
                                  <path fill-rule="evenodd" d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z"/>
                                </svg>
                            </button>
                        </form>
                      </div>
                </div>
                </div>
            </div>
            <br>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}